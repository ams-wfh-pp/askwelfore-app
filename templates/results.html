<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Your WelFore Personalized Plan</title>
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      min-height: 100vh;
      padding: 20px;
    }
    .container {
      max-width: 900px;
      margin: 0 auto;
      background: white;
      border-radius: 16px;
      padding: 40px;
      box-shadow: 0 20px 60px rgba(0,0,0,0.3);
    }

    /* Header & Award Section */
    .award-banner { text-align: center; margin-bottom: 25px; }
    .award-banner img { max-width: 200px; filter: drop-shadow(0 3px 8px rgba(0,0,0,0.2)); }
    .award-caption { font-size: 1rem; color: #4a5568; font-weight: 600; margin-top: 8px; }

    .header { text-align: center; margin-bottom: 30px; }
    .header h1 { color: #2d3748; font-size: 2rem; margin-bottom: 10px; }
    .header p { color: #4a5568; line-height: 1.6; }

    /* üåà Flavor Balance Index */
    .flavor-index-box {
      background: linear-gradient(135deg, #e0f7fa, #f1f8e9);
      text-align: center;
      padding: 25px;
      border-radius: 16px;
      margin-bottom: 30px;
      box-shadow: 0 6px 12px rgba(0,0,0,0.08);
    }
    .flavor-index-box h2 { color: #2b6cb0; font-weight: 700; font-size: 1.8em; margin-bottom: 10px; }
    .flavor-index-box .score { font-size: 3rem; color: #2b6cb0; font-weight: 800; }
    .flavor-index-box p { color: #333; margin-top: 10px; font-size: 1.05rem; }

    /* Upsell */
    .premium-upsell {
      background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
      color: white;
      padding: 25px;
      border-radius: 12px;
      margin-bottom: 30px;
      text-align: center;
    }
    .premium-upsell h3 { margin-bottom: 10px; font-size: 1.5rem; }
    .premium-upsell a {
      display: inline-block;
      background: white;
      color: #f5576c;
      padding: 12px 30px;
      border-radius: 8px;
      text-decoration: none;
      font-weight: 600;
      margin-top: 15px;
      transition: transform 0.2s;
    }
    .premium-upsell a:hover { transform: translateY(-2px); }

    /* Plan Overview */
    .plan-summary {
      background: #f7fafc;
      padding: 20px;
      border-radius: 12px;
      margin-bottom: 30px;
    }
    .plan-summary h3 { color: #2d3748; margin-bottom: 15px; }
    .info-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 15px;
    }
    .info-item {
      background: white;
      padding: 12px;
      border-radius: 8px;
      border-left: 3px solid #667eea;
    }
    .info-label { font-size: 0.85rem; color: #718096; margin-bottom: 4px; }
    .info-value { color: #2d3748; font-weight: 600; }

    /* Hydration Tip */
    .hydration-tip {
      background:#ebf8ff;
      padding:15px;
      border-radius:12px;
      text-align:center;
      margin-bottom:25px;
      color:#2b6cb0;
      font-weight:600;
    }

    /* Meal Plan */
    .meal-plan { margin-bottom: 30px; }
    .meal-plan h3 { color: #2d3748; margin-bottom: 20px; font-size: 1.5rem; }
    .day-card {
      background: #f7fafc;
      border-radius: 12px;
      padding: 20px;
      margin-bottom: 20px;
      border-left: 4px solid #667eea;
    }
    .day-card h4 { color: #667eea; margin-bottom: 15px; font-size: 1.2rem; }
    .meal-item {
      background: white;
      padding: 12px;
      margin-bottom: 10px;
      border-radius: 8px;
      color: #4a5568;
    }

    /* Color Badges */
    .color-badges { display: flex; gap: 8px; flex-wrap: wrap; margin-top: 10px; }
    .color-badge { padding: 4px 12px; border-radius: 20px; font-size: 0.85rem; font-weight: 600; }
    .color-badge.red { background: #fed7d7; color: #c53030; }
    .color-badge.orange { background: #feebc8; color: #c05621; }
    .color-badge.yellow { background: #fefcbf; color: #975a16; }
    .color-badge.green { background: #c6f6d5; color: #22543d; }
    .color-badge.blue-purple { background: #e9d8fd; color: #553c9a; }
    .color-badge.white { background: #e2e8f0; color: #2d3748; }

    /* Snack + Flavor Boost */
    .snack-tip, .flavor-boost {
      border-radius: 12px;
      padding: 20px;
      margin: 25px 0;
      text-align: center;
      box-shadow: 0 4px 8px rgba(0,0,0,0.05);
    }
    .snack-tip { background:#edf2f7; color:#2d3748; }
    .flavor-boost { background:#fff7ed; color:#78350f; }

    /* PDF Recommendations */
    .pdf-recommendations {
      background: #f7fafc;
      padding: 20px;
      border-radius: 12px;
      margin-bottom: 30px;
    }
    .pdf-item {
      background: white;
      padding: 15px;
      margin-bottom: 12px;
      border-radius: 8px;
      border-left: 3px solid #48bb78;
    }

    /* Buttons */
    .cta-buttons {
      display: flex;
      gap: 15px;
      margin-top: 30px;
    }
    .cta-btn {
      flex: 1;
      text-align: center;
      padding: 15px;
      border-radius: 8px;
      text-decoration: none;
      font-weight: 600;
      transition: transform 0.2s;
    }
    .cta-btn:hover { transform: translateY(-2px); }
    .cta-btn.primary {
      background: linear-gradient(135deg, #667eea, #764ba2);
      color: white;
    }
    .cta-btn.secondary {
      background: #e2e8f0;
      color: #2d3748;
    }

    footer {
      text-align:center;
      margin-top:40px;
      color:#718096;
      font-size:0.85rem;
    }
    footer img {
      max-width:120px;
      display:block;
      margin:0 auto 10px;
    }
  </style>
</head>

<body>
  <div class="container">
    <div class="award-banner">
      <img src="/static/WelFore-Health-logo.png" alt="WelFore Health Logo" />
      <p class="award-caption">Flavor-First ‚Ä¢ Eat the Rainbow ‚Ä¢ Culturally Inclusive Wellness</p>
    </div>

    {% if error %}
    <div class="error">
      <h2>Oops! Something went wrong.</h2>
      <p>{{ error_message }}</p>
    </div>
    {% else %}

    <div class="header">
      <h1>üåà Your Flavor-Full Wellness Plan</h1>
      <p><strong>{{ meal_plan.user_name }}</strong>, here‚Äôs your personalized, flavor-forward journey ‚Äî balanced by color, culture, and joy. Let‚Äôs make healthy eating stick, one delicious day at a time!</p>
    </div>

    {% if flavor_balance_index %}
    <div class="flavor-index-box">
      <h2>üåø Your Flavor Balance Index</h2>
      <div class="score">{{ flavor_balance_index }}/100</div>
      {% if flavor_balance_index >= 90 %}
        <p>üî• Incredible! You‚Äôre balancing flavor and nutrition like a pro chef.</p>
      {% elif flavor_balance_index >= 80 %}
        <p>üåø Great work ‚Äî your meals are bursting with color and confidence!</p>
      {% else %}
        <p>üåà You‚Äôre off to a delicious start! Add one more color tomorrow to boost your index.</p>
      {% endif %}
    </div>
    {% endif %}

    {% if meal_plan.is_premium %}
    <div class="premium-upsell">
      <h3>{{ meal_plan.premium_message }}</h3>
      <p>You've selected a {{ meal_plan.plan_duration }}-day plan. Unlock the full experience with our premium subscription!</p>
      <a href="{{ meal_plan.stripe_link }}" target="_blank">Upgrade Now ‚Üí</a>
    </div>
    {% endif %}

    <div class="plan-summary">
      <h3>üìã Your Plan Overview</h3>
      <div class="info-grid">
        <div class="info-item"><div class="info-label">Duration</div><div class="info-value">{{ meal_plan.plan_duration }} Days</div></div>
        <div class="info-item"><div class="info-label">Primary Cuisine</div><div class="info-value">{{ meal_plan.primary_cuisine }}</div></div>
        <div class="info-item"><div class="info-label">Avg Colors/Day</div><div class="info-value">{{ meal_plan.average_colors_per_day }} colors</div></div>
        <div class="info-item"><div class="info-label">Daily Protein</div><div class="info-value">{{ meal_plan.nutrition_targets.protein_daily }}</div></div>
        <div class="info-item"><div class="info-label">Daily Fiber</div><div class="info-value">{{ meal_plan.nutrition_targets.fiber_daily }}</div></div>
        <div class="info-item"><div class="info-label">Hydration Goal</div><div class="info-value">{{ meal_plan.nutrition_targets.hydration }}</div></div>
      </div>
    </div>

    <div class="hydration-tip">üíß Hydration Highlight: {{ meal_plan.nutrition_targets.hydration }} per day ‚Äî flavor it with lemon, mint, or cucumber!</div>

    <div class="meal-plan">
      <h3>üçΩÔ∏è Your Daily Meal Plan</h3>
      {% for day in meal_plan.meal_plan %}
      <div class="day-card">
        <h4>Day {{ day.day }} - {{ day.colors_achieved }} Colors Achieved üåà</h4>
        {% for meal in day.meals %}
          <div class="meal-item">{{ meal }}</div>
        {% endfor %}
        <div class="color-badges">
          {% for color in day.colors %}
            <span class="color-badge {{ color }}">{{ color }}</span>
          {% endfor %}
        </div>
      </div>
      {% endfor %}
    </div>

    <div class="snack-tip">
      <h3>ü•™ Snack Smart</h3>
      <p>Mid-morning & mid-afternoon snacks keep your energy stable. Aim for <strong>1 Protein + 1 Color or Whole-Grain</strong> combo ‚Äî like yogurt with berries or hummus with carrots.</p>
    </div>

    <div class="flavor-boost">
      <h3>üåø Flavor Boost</h3>
      <p>Enhance dinners with fresh herbs: <strong>Basil</strong> for Mediterranean, <strong>Cilantro</strong> for Latin dishes, <strong>Thyme</strong> for Caribbean, <strong>Ginger</strong> for Asian flavors.</p>
    </div>

    {% if pdf_recommendations %}
    <div class="pdf-recommendations">
      <h3>üìö Recommended Wellness Guides</h3>
      {% for pdf in pdf_recommendations %}
        <div class="pdf-item">
          <h4>{{ pdf.title }}</h4>
          <p>{{ pdf.description }}</p>
        </div>
      {% endfor %}
    </div>
    {% endif %}

    <div class="cta-buttons">
      <a href="/" class="cta-btn secondary">‚Üê Take Quiz Again</a>
      {% if not meal_plan.is_premium %}
      <a href="{{ meal_plan.stripe_link or '#' }}" class="cta-btn primary">Upgrade to Premium ‚Üí</a>
      {% endif %}
    </div>

    {% if generated_at %}
    <p class="timestamp">Generated on {{ generated_at }}</p>
    {% endif %}
    {% endif %}

    <footer>
      <img src="/static/WelFore-Health-logo.png" alt="WelFore Health Logo" />
      <p>¬© 2025 WelFore Health LLC. All Rights Reserved.</p>
      <p>Powered by the <strong>FlavURWay Teaching Kitchen Collective</strong>.</p>
      <p style="margin-top:10px;font-style:italic;">This plan is for educational purposes and not a substitute for medical advice.</p>
    </footer>
  </div>
</body>
</html>
